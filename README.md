
---

# Welcome to Fundamentals of Database Management System (DBMS) Learning Materials


## Week One

<blockquote>

<details>
<summary> Day 1: Introduction DBMS and its Characteristics</summary>
<blockquote> 

- [Video 1: Introduction about DBMS](https://www.youtube.com/watch?v=6Iu45VZGQDk&list=PLBlnK6fEyqRi_CUQ-FXxgzKQ1dwr_ZJWZ&index=1 "Introduction to Database Management System") 
</blockquote>

<blockquote> 

 - [Video 2: DBMS Characteristics](https://www.youtube.com/watch?v=wClEbCyWryI&list=PLBlnK6fEyqRi_CUQ-FXxgzKQ1dwr_ZJWZ&index=2 "Characteristics of Database Management System") 
</blockquote>

</details>

<details>
<summary> Day 2: DBMS Users and its Advantages & Disadvantages</summary>
<blockquote> 

 - [Video 1: DBMS Users](https://www.youtube.com/watch?v=qoAL4MA3P08&list=PLBlnK6fEyqRi_CUQ-FXxgzKQ1dwr_ZJWZ&index=3 "Characteristics of Database Management System") 
</blockquote>

<blockquote> 

 - [Video 2: Advantages and Disadvantages](https://www.youtube.com/watch?v=YcYF-kxE0Sw&list=PLBlnK6fEyqRi_CUQ-FXxgzKQ1dwr_ZJWZ&index=4 "Advantages and Disadvantages of Database Management System") 
</blockquote>

</details>

<details>
<summary> Day 3: Fundamentals of Database System </summary>
<blockquote> 

 - [Video 1: Fundamentals of Database System](https://www.youtube.com/watch?v=qMAxQh6Xilo&list=PLBlnK6fEyqRi_CUQ-FXxgzKQ1dwr_ZJWZ&index=6 "Fundamentals of Database System") 
</blockquote>
</details>

<details>
<summary> Day 4: Three-Schema Architecture & Data Independence </summary>
<blockquote> 

 - [Video 1: Three-Schema Architecture & Data Independence](https://www.youtube.com/watch?v=vuXnRRG-m5M&list=PLBlnK6fEyqRi_CUQ-FXxgzKQ1dwr_ZJWZ&index=7 "Three-Schema Architecture & Data Independence") 
</blockquote>
</details>

<details>
<summary> Day 5: DBMS Languages, Interfaces & Classification and DB Environment </summary>
<blockquote> 

 - [Video 1: DBMS Languages, Interfaces & Classification](https://www.youtube.com/watch?v=DkEMtOFMNQE&list=PLBlnK6fEyqRi_CUQ-FXxgzKQ1dwr_ZJWZ&index=8 "DBMS Languages, Interfaces & Classification") 
 - [Video 2: DB Environment](https://www.youtube.com/watch?v=rqcTHitakDM&list=PLBlnK6fEyqRi_CUQ-FXxgzKQ1dwr_ZJWZ&index=9 "Database Environment") 
</blockquote>
</details>

</blockquote>

---

## Week Two

<blockquote>

<details>
<summary> Day 1: DBMS Architecture and the Basic Concepts of Entity-Relationship Model</summary>
<blockquote> 

 - [Video 1: DBMS Architecture](https://www.youtube.com/watch?v=dftMGbbULhE&list=PLBlnK6fEyqRi_CUQ-FXxgzKQ1dwr_ZJWZ&index=10 "DBMS Architecture") 
</blockquote>

<blockquote> 

 - [Video 2: Basic Concepts of Entity-Relationship Model](https://www.youtube.com/watch?v=wOD02sezmX8&list=PLBlnK6fEyqRi_CUQ-FXxgzKQ1dwr_ZJWZ&index=11 "Basic Concepts of Entity-Relationship Model") 
</blockquote>

</details>


<details>
<summary> Day 2: Database Design Process and the Concept of Relationships in ER Diagram</summary>
<blockquote> 

 - [Video 1: Database Design Process](https://www.youtube.com/watch?v=7m6gXeMDaHc&list=PLBlnK6fEyqRi_CUQ-FXxgzKQ1dwr_ZJWZ&index=12 "Database Design Process") 
</blockquote>

<blockquote> 

 - [Video 2: Concept of Relationships in ER Diagram](https://www.youtube.com/watch?v=n3mHfQft5P8&list=PLBlnK6fEyqRi_CUQ-FXxgzKQ1dwr_ZJWZ&index=13 "Concept of Relationships in ER Diagram") 
</blockquote>
</details>

<details>
<summary> Day 3: Exercises based on ER Model Concepts </summary>
<blockquote> 

 - [Video 1: Exercises based on ER Model Concepts (Part 1)](https://www.youtube.com/watch?v=l9BRmq7pgZ8&list=PLBlnK6fEyqRi_CUQ-FXxgzKQ1dwr_ZJWZ&index=14 "Exercises based on ER Model Concepts (Part 1)") 
</blockquote>

<blockquote> 

 - [Video 1: Exercises based on ER Model Concepts (Part 2)](https://www.youtube.com/watch?v=BexmtjyRp6I&list=PLBlnK6fEyqRi_CUQ-FXxgzKQ1dwr_ZJWZ&index=15 "Exercises based on ER Model Concepts (Part 2)") 
</blockquote>

</details>

<details>
<summary> Day 4: Introduction to Relational Data Model and Characteristics of Relations</summary>
<blockquote> 

 - [Video 1: Introduction to Relational Data Model](https://www.youtube.com/watch?v=Q45sr5p_NmQ&list=PLBlnK6fEyqRi_CUQ-FXxgzKQ1dwr_ZJWZ&index=16 "Introduction to Relational Data Model") 
</blockquote>

<blockquote> 

 - [Video 2: Characteristics of Relations](https://www.youtube.com/watch?v=J4hZbuTLyhI&list=PLBlnK6fEyqRi_CUQ-FXxgzKQ1dwr_ZJWZ&index=17 "Characteristics of Relations") 
</blockquote>

</details>

</blockquote>

---

## Week Three

<blockquote>

<details>
<summary> Day 1: Relational Model Constraints, Update Operations/Dealing with Constraint Violations </summary>
<blockquote> 

 - [Video 1: Relational Model Constraints](https://www.youtube.com/watch?v=uPOGPL2C0_8&list=PLBlnK6fEyqRi_CUQ-FXxgzKQ1dwr_ZJWZ&index=18 "Relational Model Constraints") 
</blockquote>

<blockquote> 

 - [Video 2: Update Operations/Dealing with Constraint Violations](https://www.youtube.com/watch?v=lMthy1iwR3s&list=PLBlnK6fEyqRi_CUQ-FXxgzKQ1dwr_ZJWZ&index=19 "Update Operations/Dealing with Constraint Violations") 
</blockquote>

</details>

<details>
<summary> Day 2: Exercises based on Relational Model </summary>
<blockquote> 

 - [Video 1: Exercises based on Relational Model (Part 1)](https://www.youtube.com/watch?v=BZVWPsa08Jw&list=PLBlnK6fEyqRi_CUQ-FXxgzKQ1dwr_ZJWZ&index=20 "Exercises based on Relational Model (Part 1)") 
</blockquote>

<blockquote> 

 - [Video 2: Exercises based on Relational Model (Part 2)](https://www.youtube.com/watch?v=xhohP0rZcB0&list=PLBlnK6fEyqRi_CUQ-FXxgzKQ1dwr_ZJWZ&index=21 "Exercises based on Relational Model (Part 2)") 
</blockquote>

</details>

<details>
<summary> Day 3: Relational Algebra Operations - Unary, Set Theory, & Binary </summary>
<blockquote> 

 - [Video 1: Relational Algebra Operations - Unary](https://www.youtube.com/watch?v=8PJGw123zeE&list=PLBlnK6fEyqRi_CUQ-FXxgzKQ1dwr_ZJWZ&index=22 "Relational Algebra Operations - Unary") 
</blockquote>

<blockquote> 

 - [Video 2: Relational Algebra Operations - Set Theory](https://www.youtube.com/watch?v=r6OsT9Zi4Cg&list=PLBlnK6fEyqRi_CUQ-FXxgzKQ1dwr_ZJWZ&index=23 "Relational Algebra Operations - Set Theory") 
</blockquote>

<blockquote> 

 - [Video 3: Relational Algebra Operations - Binary](https://www.youtube.com/watch?v=sJtuZq-LEQM&list=PLBlnK6fEyqRi_CUQ-FXxgzKQ1dwr_ZJWZ&index=24 "Relational Algebra Operations - Binary") 
</blockquote>
</details>


<details>
<summary> Day 4: Additional Relational Algebra Operations, Relational Algebra Queries </summary>
<blockquote> 

 - [Video 1: Additional Relational Algebra Operations](https://www.youtube.com/watch?v=4kqoN9-rqiQ&list=PLBlnK6fEyqRi_CUQ-FXxgzKQ1dwr_ZJWZ&index=25 "Additional Relational Algebra Operations") 
</blockquote>

<blockquote> 

 - [Video 2: Relational Algebra Queries (Part 1)](https://www.youtube.com/watch?v=Dgq01JAWw4Y&list=PLBlnK6fEyqRi_CUQ-FXxgzKQ1dwr_ZJWZ&index=26 "Relational Algebra Queries (Part 1)") 
</blockquote>

<blockquote> 

 - [Video 3: Relational Algebra Queries (Part 2)](https://www.youtube.com/watch?v=4y4tBfnPlS8&list=PLBlnK6fEyqRi_CUQ-FXxgzKQ1dwr_ZJWZ&index=27 "Relational Algebra Queries (Part 2)") 
</blockquote>

</details>

</blockquote>

---

## Week Four

<blockquote>

<details>
<summary> Day 1: Basics of Structured Query Language (SQL) </summary>

<blockquote> 

## Structured Query Language (SQL)
SQL is Structured Query Language, which is a computer language for storing, manipulating and retrieving data stored in a relational database.

SQL is the standard language for Relational Database System. All the Relational Database Management Systems (RDMS) like MySQL, MS Access, Oracle, Sybase, Informix, Postgres and SQL Server use SQL as their standard database language.

Also, they are using different dialects, such as-
- MS SQL Server using T-SQL,
- Oracle using PL/SQL,
- MS Access version of SQL is called JET SQL (native format) etc.

## Applications of SQL
As mentioned before, SQL is one of the most widely used query language over the databases. I'm going to list few of them here:
- Allows users to access data in the relational database management systems.
- Allows users to describe the data.
- Allows users to define the data in a database and manipulate that data.
- Allows to embed within other languages using SQL modules, libraries & pre-compilers.
- Allows users to create and drop databases and tables.
- Allows users to create view, stored procedure, functions in a database.
- Allows users to set permissions on tables, procedures and views.

## Features of SQL
- High Performance.
- High Availability.
- Scalability and Flexibility Run anything.
- Robust Transactional Support.
- Web and Data Warehouse Strengths.
- Strong Data Protection.
- Comprehensive Application Development.
- Management Ease.
- Open Source Freedom and 24 x 7 Support.
- Lowest Total Cost of Ownership.

## Components of DBMS Environment
A DBMS is software package used to design, manage, and maintain databases. Each DBMS should have facilities to define the database, manipulate the content of the database and control the database. These facilities will help the designer, the user as well as the database administrator to discharge their responsibility in designing, using and managing the database. It provides the following facilities:

1. Data Definition Language (DDL): it manages table and index structure. The most basic items of DDL are the CREATE, ALTER, RENAME and DROP statements: 
    - CREATE: creates an object (a table, for example) in the database.  
    - DROP: deletes an object in the database, usually irretrievably.  
    - ALTER: modifies the structure an existing object in various ways. For example, adding a column to an existing table.  

2. Data Manipulation Language (DML): is the subset of SQL used to add, update and delete data. 
The acronym CRUD refers to all of the major functions that need to be implemented in a relational database application to consider it complete. Each letter in the acronym can be mapped to a standard SQL statement: 
    - CREATE: inserts new data into a database.It's SQL is INSERT INTO.
    - READ (RETRIEVE): extracts data from a database. It's SQL is SELECT
    - UPDATE: updates data in a database. It's SQL is UPDATE
    - DELETE (DESTROY): deletes data from a database. It's SQL is DELETE

3. Data Query Language (DQL): it is a language for accessing or retrieving the data organized by the appropriate data model. Since the required data or Query by the user will be extracted using this type of language, it is also called "Query Language".
    - Procedural DQL:  user specifies what data is required and how to get the data.
    - Non-Procedural DQL: user specifies what data is required but not how it is to be retrieved

4. Data Dictionary (DD): Due to the fact that a database is a self describing system, this tool, Data Dictionary, is used to store and organize information about the data stored in the database.
5. Data Control Language (DCL): 
    - Database is a shared resource that demands control of data access and usage. The database administrator should have the facility to control the overall operation of the system.
    - Data Control Languages are commands that will help the Database Administrator to control the database.
    - The commands include grant or revoke privileges to access the database or particular object within the database and to store or remove database transactions.

</blockquote>

---

</details>

<details>
<summary> Day 2: Introduction to SQL Server</summary>
<blockquote> 

## SQL Server
Microsoft is the vendor of SQL Server. The newest version is “SQL Server 2012”.  
We have different editions of SQL Server, where SQL Server Express is free to download and use. 
SQL Server uses T-SQL (Transact-SQL). T-SQL is Microsoft's proprietary extension to SQL. T-SQL is very similar to standard SQL, but in addition it supports some extra functionality, built-in functions, etc. T-SQL expands on the SQL standard to include procedural programming, local variables, various support functions for string processing, date processing, mathematics, etc. 
SQL Server consists of a Database Engine and a Management Studio (and lots of other stuff which we will not mention here). The Database engine has no graphical interface - it is just a service running in the background of your computer (preferable on the server). The Management Studio is graphical tool for configuring and viewing the information in the database. It can be installed on the server or on the client (or both). 
<img src="images/1.png">

## SQL Server Management Studio 
SQL Server Management Studio is a GUI tool included with SQL Server for configuring, managing, and administering all components within Microsoft SQL Server. The tool includes both script editors and graphical tools that work with objects and features of the server. As mentioned earlier, version of SQL Server Management Studio is also available for SQL Server Express Edition, for which it is known as SQL Server Management Studio Express. 
A central feature of SQL Server Management Studio is the Object Explorer, which allows the user to browse, select, and act upon any of the objects within the server. It can be used to visually observe and analyze query plans and optimize the database performance, among others. SQL Server Management Studio can also be used to create a new database, alter any existing database schema by adding or modifying tables and indexes, or analyze performance. It includes the query windows which provide a GUI based interface to write and execute queries. 

<img src="./images/2.jpg">

When creating SQL commands and queries, the “Query Editor” (select “New Query” from the Toolbar) is used (shown in the figure above). 
With SQL and the “Query Editor” we can do almost everything with code, but sometimes it is also a good idea to use the different Designer tools in SQL to help us do the work without coding (so much). 

## Create a new Database 
It is quite simple to create a new database in Microsoft SQL Server. Just right-click on the 
“Databases” node and select “New Database…” 

<img src="images/3.jpg">

There are lots of settings you may set regarding your database, but the only information you must fill in is the name of your database: 

<img src="images/4.jpg">

You may also use the SQL language to create a new database, but sometimes it is easier to just use the built-in features in the Management Studio.

## Queries 
In order to make a new SQL query, select the “New Query” button from the Toolbar. 

<img src="images/5.jpg">

Here we can write any kind of queries that is supported by the SQL language. 

## CREATE TABLE 
Before you start implementing your tables in the database, you should always spend some time design your tables properly using a design tool like, e.g., ERwin, Toad Data Modeler or Visio. This is called Database Modeling. 

<img src="images/6.jpg">
The CREATE TABLE statement is used to create a table in a database.

Syntax: 
<blockquote>
CREATE TABLE table_name 
( 
    column_name1 data_type, 
    column_name2 data_type, 
    column_name3 data_type, 
    .... 
) 
</blockquote> 
The data type specifies what type of data the column can hold. 
You have special data types for numbers, text dates, etc. 
Examples: 

- Numbers: int, float 
- Text/Stings: varchar(X) – where X is the length of the string 
- Dates: datetime 
- etc. 

Example: 
We want to create a table called “CUSTOMER” which has the following columns and data types: 

<img src="images/7.jpg">

<blockquote>
CREATE TABLE CUSTOMER 
( 
 	
    CustomerId int IDENTITY(1,1) PRIMARY KEY, 
 	CustomerNumber int NOT NULL UNIQUE, 
 	LastName varchar(50) NOT NULL, 
 	FirstName varchar(50) NOT NULL, 
 	AreaCode int NULL, 
 	Address varchar(50) NULL, 
 	Phone varchar(50) NULL, 
) 
GO 
</blockquote>

## Best practice

When creating tables you should consider following these guidelines: 
- Tables: Use upper case and singular form in table names – not plural, e.g., “CUSTOMER”. Never use spaces inside the table names. 
- Columns: Use Pascal notation, e.g., “CustomerId”. Never use spaces inside the column names. 
- Primary Keys: Use Integer and Identity(1,1) for Primary Keys. Then the Primary Keys will just be a running number that is automatically inserted by the system. It is also a good idea to name the Primary Key column the same as the table name + Id, e.g., if the table name is “CUSTOMER” (upper case), then the Primary Key column should be named “CustomerId” (Pascal notation).

</blockquote>

## Create Tables using the Designer Tools 
Even if you can do “everything” using the SQL language, it is sometimes easier to do it in the designer tools in the Management Studio in SQL Server. 
Instead of creating a script you may as well easily use the designer for creating tables. 
- Step1: Select “New Table …”: 
  
  <img src="images/8.jpg">
- Step2: Next, the table designer pops up where you can add columns, data types, etc.
  
<img src="images/9.jpg">

In this designer we may also specify Column Names, Data Types, etc. 
Step 3: Save the table by clicking the Save button.

</details>

<details>
<summary> Day 3: SQL Constraints </summary>

## SQL Constraints 
Constraints are used to limit the type of data that can go into a table. 
Constraints can be specified when a table is created (with the CREATE TABLE statement) or after the table is created (with the ALTER TABLE statement). 
Here are the most important constraints: 
- PRIMARY KEY 
- NOT NULL 
- UNIQUE 
- FOREIGN KEY 
- CHECK 
- DEFAULT 
- IDENTITY 

In the sections below we will explain some of these in detail. 

## PRIMARY KEY 
The PRIMARY KEY constraint uniquely identifies each record in a database table. 

Primary keys must contain unique values. It is normal to just use running numbers, like 1, 2, 3, 4, 5, … as values in Primary Key column. It is a good idea to let the system handle this for you by specifying that the Primary Key should be set to identity(1,1). IDENTITY(1,1) means the first value will be 1 and then it will increment by 1. 

Each table should have a primary key, and each table can have only ONE primary key. 

If we take a closer look at the CUSTOMER table created earlier: 

<blockquote>
CREATE TABLE [CUSTOMER] 
( 
 	
    CustomerId int IDENTITY(1,1) PRIMARY KEY, 
 	CustomerNumber int NOT NULL UNIQUE, 
 	LastName varchar(50) NOT NULL, 
 	FirstName varchar(50) NOT NULL, 
 	AreaCode int NULL, 
 	Address varchar(50) NULL, 
 	Phone varchar(50) NULL, 
) 
GO 
</blockquote>

As you see we use the “Primary Key” keyword to specify that a column should be the Primary Key. 

<img src="images/10.jpg">

## Setting Primary Keys in the Designer Tools: 
If you use the Designer tools in SQL Server you can easily set the primary Key in a table just by right-click and select “Set primary Key”.  

<img src="images/11.jpg">

The primary Key column will then have a small key   in front to illustrate that this column is a Primary Key.

## FOREIGN KEY 
A FOREIGN KEY in one table points to a PRIMARY KEY in another table. 
Example: 

<img src="images/12.jpg">

We will create a CREATE TABLE script for these tables: 

<img src="images/13.jpg">

The FOREIGN KEY constraint is used to prevent actions that would destroy links between tables. 

The FOREIGN KEY constraint also prevents that invalid data from being inserted into the foreign key column, because it has to be one of the values contained in the table it points to. 

## Setting Foreign Keys in the Designer Tools: 
If you want to use the designer, right-click on the column that you want to be the Foreign Key and select “Relationships…”:  

<img src="images/14.jpg">

The following window pops up (Foreign Key Relationships): 

<img src="images/15.jpg">

Click on the “Add” button and then click on the small “…” button. Then the following window pops up (Tables and Columns): 

<img src="images/16.jpg">

Here you specify the primary Key Column in the Primary Key table and the Foreign Key Column in the Foreign Key table. 

## NOT NULL / Required Columns 
The NOT NULL constraint enforces a column to NOT accept NULL values. 

The NOT NULL constraint enforces a field to always contain a value. This means that you cannot insert a new record, or update a record without adding a value to this field. 

If we take a closer look at the CUSTOMER table created earlier: 

<img src="images/17.jpg">

We see that “CustomerNumber”, “LastName” and “FirstName” is set to “NOT NULL”, this means these columns needs to contain data. While “AreaCode”, “Address” and “Phone” may be left empty, i.e, they don’t need to filled out. 

Note! A primary key column cannot contain NULL values. 

## Setting NULL/NOT NULL in the Designer Tools 
In the Table Designer you can easily set which columns that should allow NULL or not: 

<img src="images/18.jpg">

## UNIQUE 
The UNIQUE constraint uniquely identifies each record in a database table. The UNIQUE and PRIMARY KEY constraints both provide a guarantee for uniqueness for a column or set of columns. 

A PRIMARY KEY constraint automatically has a UNIQUE constraint defined on it. 

Note! You can have many UNIQUE constraints per table, but only one PRIMARY KEY constraint per table. 

If we take a closer look at the CUSTOMER table created earlier: 

<img src="images/19.jpg">

We see that the “CustomerNumber” is set to UNIQUE, meaning each customer must have a unique Customer Number. Example: 

<img src="images/20.jpg">

## Setting UNIQUE in the Designer Tools: 
If you want to use the designer, right-click on the column that you want to be UNIQUE and select “Indexes/Keys…”:  

<img src="images/21.jpg">

Then click “Add” and then set the “Is Unique” property to “Yes”: 

<img src="images/22.jpg">

## CHECK 
The CHECK constraint is used to limit the value range that can be placed in a column. 

If you define a CHECK constraint on a single column it allows only certain values for this column. 

If you define a CHECK constraint on a table it can limit the values in certain columns based on values in other columns in the row. 
Example: 

<img src="images/23.jpg">

In this case, when we try to insert a Customer Number less than zero we will get an error message. 

## Setting CHECK constraints in the Designer Tools: 
If you want to use the designer, right-click on the column where you want to set the constraints and select “Check Constraints…”: 

<img src="images/24.jpg">

Then click “Add” and then click “…” in order to open the Expression window: 

<img src="images/25.jpg">

In the Expression window you can type in the expression you want to use: 

<img src="images/26.jpg">

## DEFAULT 
The DEFAULT constraint is used to insert a default value into a column. 
The default value will be added to all new records, if no other value is specified. 

Example: 

<img src="images/27.jpg">

## Setting DEFAULT values in the Designer Tools: 
Select the column and go into the “Column Properties”: 

<img src="images/28.jpg">

## AUTO INCREMENT or IDENTITY 
Very often we would like the value of the primary key field to be created automatically every time a new record is inserted. 

Example: 

<img src="images/29.jpg">

As shown below, we use the IDENTITY() for this. IDENTITY(1,1) means the first value will be 1 and then it will increment by 1. 
 
## Setting identity(1,1) in the Designer Tools: 
We can use the designer tools to specify that a Primary Key should be an identity column that is automatically generated by the system when we insert data in to the table. 

Click on the column in the designer and go into the Column Properties window: 

<img src="images/30.jpg">

</details>

<details>
<summary> Day 4: SQL Query Types </summary>

## ALTER TABLE 
The ALTER TABLE statement is used to add, delete, or modify columns in an existing table. 
 
To add a column in a table, use the following syntax: 

<img src="images/31.jpg">

To delete a column in a table, use the following syntax (notice that some database systems don't allow deleting a column): 

<img src="images/32.jpg">

To change the data type of a column in a table, use the following syntax: 

<img src="images/33.jpg">

If we use CREATE TABLE and the table already exists in the table we will get an error message, so if we combine CREATE TABLE and ALTER TABLE we can create robust database scripts that gives no errors, as the example shown below: 

<img src="images/34.jpg">

## INSERT INTO 
The INSERT INTO statement is used to insert a new row in a table. 
It is possible to write the INSERT INTO statement in two forms.  

The first form doesn't specify the column names where the data will be inserted, only their values: 

INSERT INTO table_name VALUES (value1, value2, value3, ...) 

Example: 
<blockquote>
INSERT INTO CUSTOMER VALUES ('1000', 'Smith', 'John', 12, 'California', '11111111') 
 </blockquote>

The second form specifies both the column names and the values to be inserted: 
<blockquote>
INSERT INTO table_name (column1, column2, column3,...) 
                VALUES (value1, value2, value3,...) 
</blockquote>
This form is recommended! 

Example: 
<blockquote>
INSERT INTO CUSTOMER (CustomerNumber, LastName, FirstName, AreaCode, 
Address, Phone)  
              VALUES ('1000', 'Smith', 'John', 12, 'California', '11111111') 
</blockquote>


## Insert Data Only in Specified Columns: 
It is also possible to only add data in specific columns. 
Example: 
<blockquote>
INSERT INTO CUSTOMER (CustomerNumber, LastName, FirstName)  
              VALUES ('1000', 'Smith', 'John') 
</blockquote>

Note! You need at least to include all columns that cannot be NULL. 

We remember the table definition for the CUSTOMER table: INSERT INTO

<img src="images/35.jpg">

i.e., we need to include at least “CustomerNumber”, “LastName” and “FirstName”. “CustomerId” is set to “identity(1,1)” and therefore values for this column are generated by the system. 

## Insert Data in the Designer Tools: 
When you have created the tables you can easily insert data into them using the designer tools. Right-click on the specific table and select “Edit Top 200 Rows”: 

<img src="images/36.jpg">

Then you can enter data in a table format, similar to, e.g., MS Excel: 

<img src="images/37.jpg">

</details>

<details>
<summary> Day 5: UPDATE, DELETE and SELECT Queries </summary>

## UPDATE 
The UPDATE statement is used to update existing records in a table. 
The syntax is as follows: 
<blockquote>
UPDATE table_name SET column1=value, column2=value2,... 
                  WHERE some_column=some_value 
</blockquote>

Note! Notice the WHERE clause in the UPDATE syntax. The WHERE clause specifies which record or records that should be updated. If you omit the WHERE clause, all records will be updated! 

Example: 

<blockquote>
UPDATE CUSTOMER set AreaCode=46 where CustomerId=2 
</blockquote>

Before update: 
  
<img src="images/38.jpg">

After update: 
  
<img src="images/39.jpg">

If you don’t include the WHERE clause the result becomes: 

<img src="images/40.jpg">
  
→ So make sure to include the WHERE clause when using the UPDATE command! 
 
## Update Data in the Designer Tools: 
The same way you insert data you can also update the data. Right-click on the specific table and select “Edit Top 200 Rows”: 
  
<img src="images/41.jpg"> 

Then you can change your data:

<img src="images/42.jpg">

## DELETE 
The DELETE statement is used to delete rows in a table. 

Syntax: 
<blockquote>
DELETE FROM table_name WHERE some_column=some_value 
</blockquote>

Note! Notice the WHERE clause in the DELETE syntax. The WHERE clause specifies which record or records that should be deleted. If you omit the WHERE clause, all records will be deleted! 

Example: 

<blockquote>
DELETE from CUSTOMER where CustomerId=2 
</blockquote>

Before delete: 
  
<img src="images/43.jpg">

After delete: 
  
<img src="images/44.jpg">
 
## Delete All Rows: 
It is possible to delete all rows in a table without deleting the table. This means that the table structure, attributes, and indexes will be intact: 
<blockqoute>
DELETE FROM table_name 
</blockqoute>

Note! Make sure to do this only when you really mean it! You cannot UNDO this statement! 

## Delete Data in the Designer Tools: 
You delete data in the designer by right-click on the row and select “Delete”: 

<img src="images/45.jpg">

---
---

## SELECT 
The SELECT statement is probably the most used SQL command. The SELECT statement is used for retrieving rows from the database and enables the selection of one or many rows or columns from one or many tables in the database. 

We will use the CUSTOMER table as an example.  

The CUSTOMER table has the following columns: 
 
<img src="images/46.jpg">
  
The CUSTOMER table contains the following data: 

<img src="images/47.jpg">
 
Example: 

<blockquote>
SELECT * from CUSTOMER 
</blockquote>

<img src="images/48.jpg">

This simple example gets all the data in the table CUSTOMER. The symbol “*” is used when you want to get all the columns in the table. 
 
 
If you only want a few columns, you may specify the names of the columns you want to retrieve, example: 

<blockquote>
SELECT CustomerId, LastName, FirstName from CUSTOMER 
</blockquote>
  
<img src="images/49.jpg">
 
So in the simplest form we can use the SELECT statement as follows: 

<blockqoute>
SELECT <column_names> from <table_names> 
</blockqoute>

If we want all columns, we use the symbol “*” 

Note! SQL is not case sensitive. SELECT is the same as select. 


The full syntax of the SELECT statement is complex, but the main clauses can be summarized as: 

<blockquote>
SELECT  
[ ALL | DISTINCT ]  
    [TOP ( expression ) [PERCENT] [ WITH TIES ] ] select_list [ INTO new_table ]  
[ FROM table_source ] [ WHERE search_condition ]  
[ GROUP BY group_by_expression ]  
[ HAVING search_condition ]  
[ ORDER BY order_expression [ ASC | DESC ] ]
</blockquote>

It seems complex, but we will take the different parts step by step in the next sections. 


## Select Data in the Designer Tools: 
Right-click on a table and select “Select Top 1000 Rows”: 

<img src="images/50.jpg">

The following will appear: 

<img src="images/51.jpg">

A Select query is automatically created for you which you can edit if you want to. 

## The ORDER BY Keyword 
If you want the data to appear in a specific order you need to use the “order by” keyword. 

Example: 
<blockquote>
SELECT * from CUSTOMER order by LastName 
</blockquote>

<img src="images/52.jpg">

You may also sort by several columns, e.g. like this: 

<blockquote>
SELECT * from CUSTOMER order by Address, LastName 
</blockquote>
  
<img src="images/53.jpg">

If you use the “order by” keyword, the default order is ascending (“asc”). If you want the order to be opposite, i.e., descending, then you need to use the “desc” keyword.

<blockquote>
SELECT ect * from CUSTOMER order by LastName desc 
</blockquote>
  
<img src="images/54.jpg">

## SELECT DISTINCT 
In a table, some of the columns may contain duplicate values. This is not a problem, however, sometimes you will want to list only the different (distinct) values in a table. 

The DISTINCT keyword can be used to return only distinct (different) values. 

The syntax is as follows: 

<blockquote>
SELECT distinct <column_names> from <table_names> 
</blockquote>

Example: 
<blockquote>
SELECT distinct FirstName from CUSTOMER 
</blockquote>

<img src="images/55.jpg">

## The WHERE Clause 
The WHERE clause is used to extract only those records that fulfill a specified criterion. 

The syntax is as follows: 

<blockquote>
SELECT column_names FROM table_name WHERE column_name = operator_value 
</blockquote>

Example: 
<blockquote>
select * from CUSTOMER where CustomerNumber='1001' 
</blockquote>

<img src="images/56.jpg">

Note! SQL uses single quotes around text values, as shown in the example above.

</details>


<!--DAY SIX -->


<details>
<summary> Day 6: OPERATORS </summary> 
With the WHERE clause, the following operators can be used: 

<img src="images/57.jpg">

Examples: 
<blockquote>
select * from CUSTOMER where AreaCode>30 
</blockquote>

<img src="images/58.jpg">

## LIKE Operator 
The LIKE operator is used to search for a specified pattern in a column. 

Syntax: 
<blockquote>
SELECT column_name(s) FROM table_name WHERE column_name LIKE pattern 
</blockquote>

Example: 
<blockquote>
select * from CUSTOMER where LastName like 'J%' 
</blockquote>  

<img src="images/59.jpg">

Note! The "%" sign can be used to define wildcards (missing letters in the pattern) both before and after the pattern. 
 
<blockquote>
select * from CUSTOMER where LastName like '%a%' 
</blockquote>

<img src="images/60.jpg">

You may also combine with the NOT keyword, example: 

<blockquote>
select * from CUSTOMER where LastName not like '%a%' 
</blockquote>

<img src="images/61.jpg">

---

## IN Operator 
The IN operator allows you to specify multiple values in a WHERE clause. 

Syntax: 
<blockquote>
SELECT column_name(s) FROM table_name WHERE column_name IN (value1,value2,...) 
</blockquote>

---

## BETWEEN Operator 
The BETWEEN operator selects a range of data between two values. The values can be numbers, text, or dates.
 
Syntax: 

<blockquote>
SELECT column_name(s) FROM table_name WHERE column_name BETWEEN value1 AND value2  
</blockquote>

---

## Wildcards 
SQL wildcards can substitute for one or more characters when searching for data in a database.

Note! SQL wildcards must be used with the SQL LIKE operator.

With SQL, the following wildcards can be used: 

<img src="images/62.jpg">

Examples: 
<blockquote>
SELECT * FROM CUSTOMER WHERE LastName LIKE 'J_cks_n'   
</blockquote>
 
<img src="images/63.jpg">

<blockquote>
SELECT * FROM CUSTOMER WHERE CustomerNumber LIKE '[10]%' 
</blockquote>

<img src="images/64.jpg">

--- 

## AND & OR Operators 
The AND operator displays a record if both the first condition and the second condition is true. 

The OR operator displays a record if either the first condition or the second condition is true. 

Examples: 
<blockquote>
select * from CUSTOMER where LastName='Smith' and FirstName='John' 
</blockquote> 
 
<img src="images/65.jpg">

<blockquote>
select * from CUSTOMER where LastName='Smith' or FirstName='John' 
</blockquote>

<img src="images/66.jpg">


---

## Combining AND & OR: 
You can also combine AND and OR (use parenthesis to form complex expressions). 

Example: 
<blockquote>
select * from CUSTOMER where LastName='Smith' and (FirstName='John' or FirstName='Smith') 
</blockquote>

<img src="images/67.jpg">

--- 

## SELECT TOP Clause 
The TOP clause is used to specify the number of records to return. 
The TOP clause can be very useful on large tables with thousands of records. Returning a large number of records can impact on performance. 

Syntax: 
<blockquote>
SELECT TOP number|percent column_name(s) FROM table_name 
</blockquote>


Examples: 
<blockquote>
select TOP 1 * from CUSTOMER 
</blockquote> 

<img src="images/68.jpg">
 
You can also specify in percent: 
<blockquote>
select TOP 60 percent * from CUSTOMER 
</blockquote> 

<img src="images/69.jpg">

This is very useful for large tables with thousands of records 

---

## Alias 
You can give a table or a column another name by using an alias. This can be a good thing to do if you have very long or complex table names or column names. 

An alias name could be anything, but usually it is short. 
SQL Alias Syntax for Tables: 

<blockquote>
SELECT column_name(s) 
FROM table_name AS alias_name  
</blockquote>

SQL Alias Syntax for Columns: 
<blockquote>
SELECT column_name AS alias_name 
FROM table_name 
</blockquote>

----

## Joins 
SQL joins are used to query data from two or more tables, based on a relationship between certain columns in these tables. 

<img src="images/70.jpg">

## Different SQL JOINs 
Before we continue with examples, we will list the types of JOIN you can use, and the differences between them. 
- JOIN: Return rows when there is at least one match in both tables 
- LEFT JOIN: Return all rows from the left table, even if there are no matches in the right table 
- RIGHT JOIN: Return all rows from the right table, even if there are no matches in the left table 
- FULL JOIN: Return rows when there is a match in one of the tables 
 
Example: 

Given 2 tables: 
- SCHOOL 
- CLASS 
  
The diagram is shown below: 
  
<img src="images/71.jpg">

We want to get the following information using a query: 

<img src="images/72.jpg">

In order to get information from more than one table we need to use the JOIN. The JOIN is used to join the primary key in one table with the foreign key in another table. 

<blockquote>
select SCHOOL.SchoolName, CLASS.ClassName from SCHOOLINNER JOIN CLASS ON SCHOOL.SchoolId = CLASS.SchoolId 
</blockquote>

<img src="images/73.jpg">

</details>

</blockquote>

---

## Week Five

<blockquote>

<details>
<summary> Day 1: SQL Scripts </summary> 
A SQL script is a collection of SQL statements that you can execute in one operation. You can use any kind of SQL commands, such as insert, select, delete, update, etc. In addition you can define and use variables, and you may also use program flow like If-Else, etc. You may also add comments to make the script easier to read and understand. 

## Using Comments 
Using comments in you SQL script is important to make the script easier to read and understand. 
In SQL we can use 2 different kinds of comments: 
- Single-line comment
- Multiple-line comment
   
## Single-line comment 
We can comment one line at the time using “--” before the text you want to comment out. 

Syntax: 
<blockquote>
-- text_of_comment 
</blockquote>

## Multiple-line comment 
We can comment several line using “/*” in the start of the comment and “*/” in the end of the comment. 

Syntax: 
<blockquote>
/* 
text_of_comment text_of_comment 
*/ 
</blockquote>

## Variables 
The ability to using variables in SQL is a powerful feature. You need to use the keyword DECLARE when you want to define the variables. Local variables must have the the symbol “@” as a prefix. You also need to specify a data type for your variable (int, varchar(x), etc.).  

Syntax for declaring variables: 
<blockquote>
declare @local_variable data_type 
</blockquote>

If you have more than one variable you want to declare: 

<blockquote>
declare 
@myvariable1 data_type, 
@myvariable2 data_type, … 
</blockquote>

When you want to assign values to the variable, you must use either a SET or a SELECT statement. 

Example: 
<blockquote> 
declare @myvariable int 
 
set @myvariable=4 
</blockquote>
 
If you want to see the value for a variable, you can e.g., use the PRINT command like this: 

<blockquote>
declare @myvariable int 
 
set @myvariable=4 
print @myvariable 
</blockquote>
The following will be shown in SQL Server: 
  
<img src="images/79.jpg">

Assigning variables with a value from a SELECT statement is very useful. 

We use the CUSTOMER table as an example: 

<img src="images/74.jpg">

You can assign a value to the variable from a select statement like this: 

<blockquote>
declare @mylastname varchar(50) 
 
select @mylastname=LastName from CUSTOMER where CustomerId=2 print @mylastname 
</blockquote>

<img src="images/75.jpg">

You can also use a variable in the WHERE clause LIKE, e.g., this: 

<blockquote>
declare @find varchar(30) set @find = 'J%' select * from CUSTOMER where LastName LIKE @find 
</blockquote>

<img src="images/76.jpg">

## Built-in Global Variables 
SQL have lots of built-in variables that are very useful to use in queries and scripts. 

## @@IDENTITY 
After an INSERT, SELECT INTO, or bulk copy statement is completed, @@IDENTITY contains the last identity value that is generated by the statement. If the statement did not affect any tables with identity columns, @@IDENTITY returns NULL. If multiple rows are inserted, generating multiple identity values, @@IDENTITY returns the last identity value generated. 

Example: 

Given to tables; SCHOOL and COURSE: 

<img src="images/77.jpg">
  
We want to insert a new School into the SCHOOL table and we want to insert 2 new Courses in the COURSE table that belong to the School we insert. To find the “SchoolId” we can use the @@IDENTITY variable: 

<blockquote>
declare @SchoolId int 
 
-- Insert Data into SCHOOL table 
insert into SCHOOL(SchoolName) values ('MIT') 
select @SchoolId = @@IDENTITY 
 
 
-- Insert Courses for the specific School above in the COURSE table 
insert into COURSE(SchoolId,CourseName) values (@SchoolId, 'MIT-101') 
insert into COURSE(SchoolId,CourseName) values (@SchoolId, 'MIT-201')
</blockquote>

The result becomes: 

<img src="images/78.jpg">
  
</details>

<details>
<summary> Day 2: Flow Control </summary>
As with other programming languages you can use different kind of flow control, such as IF-ELSE, WHILE, etc, which is very useful. 

## IF – ELSE 
The IF-ELSE is very useful. Below we see an example: 

<blockquote>
declare @ CustomerNumber int
select @customerNumber=CustomerNumber from CUSTOMER where CustomerId=2

if @customerNumber > 1000 
 	print 'The Customer Number is larger than 1000' 
else  	
    print 'The Customer Number is not larger than 1000'  
</blockquote>

<img src="images/80.jpg">

---

## BEGIN…END 
If more than one line of code is to be executed within an IF sentence you need to use BEGIN…END.

Example: 
<blockquote>
select @customerNumber=CustomerNumber from CUSTOMER where CustomerId=2
 
if @customerNumber > 1000 
 	begin 
 	 	print 'The Customer Number is larger than 1000'  	 	
        update CUSTOMER set AreaCode=46 where CustomerId=2  	
    end 
else 
 	print 'The Customer Number is not larger than 1000'  
</blockquote>

---

## WHILE 
We can also use WHILE, which is known from other programming languages. 

Example: 

We are using the CUSTOMER table: 

<img src="images/81.jpg">

and the following query: 

<blockquote>
while (select AreaCode from CUSTOMER where CustomerId=1) < 20 
    begin 
        update CUSTOMER set AreaCode = AreaCode + 1 
    end  
select * from CUSTOMER 
</blockquote>

<img src="images/82.jpg">

As you can see the code inside the WHILE loop is executed as long as “AreaCode” for CustomerId=1 is less than 20. For each iteration is the “AreaCode” for that customer incremented with 1. 

---

## CASE 
The CASE statement evaluates a list of conditions and returns one of multiple possible result expressions. 

Example: 

We have a “GRADE” table that contains the grades for each student in different courses: 
<blockquote>
select GradeId, StudentId, CourseId, Grade from GRADE 
</blockquote>

<img src="images/83.jpg">

In the “GRADE” table is the grades stored as numbers, but since the students get grades with the letters A..F (A=5, B=4, C=3, D=2, E=1, F=0), we want to convert the values in the table into letters using a CASE statement: 

<blockquote>
select  GradeId,  
StudentId,  CourseId, 
case Grade  
 	when 5 then 'A'  	
    when 4 then 'B'  	
    when 3 then 'C'  	
    when 2 then 'D'  	
    when 1 then 'E'  	
    when 0 then 'F' 
    else '-' end 
as Grade from GRADE
</blockquote>

<img src="images/84.jpg">

---
## CURSOR 
In advances scripts, CURSORs may be very useful. A CURSOR works like an advanced WHILE loop which we use to iterate through the records in one or more tables. 

CURSORS are used mainly in stored procedures, triggers, and SQL scripts. 

Example: 

We use the CUSTOMER table as an example: 
  
<img src="images/85.jpg">

We will create a CURSOR that iterate through all the records in the CUSTOMER table and check if the Phone number consists of 8 digits, if not the script will replace the invalid Phone number with the text “Phone number is not valid”. 
Here is the SQL Script using a CURSOR: 

<blockquote>
DECLARE 
@CustomerId int,  
@phone varchar(50)  
  
DECLARE db_cursor CURSOR  
FOR SELECT CustomerId from CUSTOMER    
OPEN db_cursor    
FETCH NEXT FROM db_cursor INTO @CustomerId    
 
WHILE @@FETCH_STATUS = 0    
BEGIN            
       select @phone=Phone from CUSTOMER where CustomerId=@CustomerId
        
       if LEN(@phone) < 8 
    update CUSTOMER set Phone='Phone number is not valid' where CustomerId=@CustomerId 
        
       FETCH NEXT FROM db_cursor INTO @CustomerId    
END    
 
CLOSE db_cursor    
DEALLOCATE db_cursor 
</blockquote>

The CUSTOMER table becomes: 

<img src="images/86.jpg">

Creating and using a CURSOR includes these steps:  
- Declare SQL variables to contain the data returned by the cursor. Declare one variable for each result set column. 
- Associate a SQL cursor with a SELECT statement using the DECLARE CURSOR statement. The DECLARE CURSOR statement also defines the characteristics of the cursor, such as the cursor name and whether the cursor is read-only or forward-only. 
- Use the OPEN statement to execute the SELECT statement and populate the cursor. 
- Use the FETCH INTO statement to fetch individual rows and have the data for each column moved into a specified variable. Other SQL statements can then reference those variables to access the fetched data values.  
- When you are finished with the cursor, use the CLOSE statement. Closing a cursor frees some resources, such as the cursor's result set and its locks on the current row. The DEALLOCATE statement completely frees all resources allocated to the cursor, including the cursor name. 
 
---

## Views 
Views are virtual table for easier access to data stored in multiple tables. 
 
<img src="images/87.jpg">

Syntax for using a View: 
<blockquote>
CREATE VIEW ViewName
AS 
… 
</blockquote>

... but it might be easier to do it in the graphical view designer that are built into SQL Management Studio. Syntax for using a View: 

<blockquote>
select * from MyView where … 
</blockquote>

As shown above, we use a VIEW just like we use an ordinary table. 
 
Example: 

We use the SCHOOL and CLASS tables as an example for our View. We want to create a View that lists all the existing schools and the belonging classes.  
  
<img src="images/88.jpg">

We create the VIEW using the CREATE VIEW command: 
<blockquote>
CREATE VIEW SchoolView 
AS 
 
SELECT SCHOOL.SchoolName, CLASS.ClassName FROM SCHOOL  
INNER JOIN CLASS ON SCHOOL.SchoolId = CLASS.SchoolId 
</blockquote>

Note! In order to get information from more than one table, we need to link the tables together using a JOIN. 

## Using the Graphical Designer 
We create the same View using the graphical designer in SQL Server Management Studio: 
 
<img src="images/89.jpg">

Step 1: Right-click on the View node and select “New View…”:  

<img src="images/90.jpg">

Step 2: Add necessary tables: 

<img src="images/91.jpg">
 
Step 3: Add Columns, etc.

<img src="images/92.jpg">

Step 4: Save the VIEW: 

<img src="images/93.jpg">

Step 5: Use the VIEW in a query: 
<blockquote>
select * from SchoolView 
</blockquote>

<img src="images/94.jpg">

</details>
 
<details>
<summary> Day 3: Stored Procedures  </summary>
A Stored Procedure is a precompiled collection of SQL statements. In a stored procedure you can use if sentence, declare variables, etc. 

<img src="images/95.jpg">

Syntax for creating a Stored Procedure: 
<blockquote>
CREATE PROCEDURE ProcedureName 
    @Parameter1 datatype 
        … declare 
    @myVariable datatype 
        … Create your Code here 
</blockquote>

Note! You need to use the symbol “@” before variable names. 

Syntax for using a Stored Procedure: 
<blockquote>
EXECUTE ProcedureName(…) 
</blockquote>
 
Example: 

We use the SCHOOL and CLASS tables as an example for our Stored Procedure. We want to create a Stored Procedure that lists all the existing schools and the belonging classes.  

<img src="images/96.jpg">
  
We create the Stored Procedure as follows: 

<blockquote>
CREATE PROCEDURE GetAllSchoolClasses 
    AS  select SCHOOL.SchoolName, CLASS.ClassName from SCHOOL 
    inner join CLASS on SCHOOL.SchoolId = CLASS.SchoolId 
    order by SchoolName, ClassName 
</blockquote>

When we have created the Stored Procedure we can run (or execute) the Stored procedure using the execute command like this: 

<blockquote>
execute GetAllSchoolClasses 
</blockquote>

<img src="images/97.jpg">

We can also create a Store Procedure with input parameters. 

Example: 

We use the same tables in this example (SCHOOL and CLASS) but now we want to list all classes for a specific school. 

The Stored Procedure becomes: 

<blockquote>
CREATE PROCEDURE GetSpecificSchoolClasses @SchoolName varchar(50) 
AS  select SCHOOL.SchoolName, CLASS.ClassName from SCHOOL 
inner join CLASS on SCHOOL.SchoolId = CLASS.SchoolId 
where SchoolName=@SchoolName order by ClassName 
</blockquote>

We run (or execute) the Stored Procedure: 
<blockquote>
execute GetSpecificSchoolClasses 'TUC' 
</blockquote>
  
<img src="images/98.jpg">

or: 
<blockquote>
execute GetSpecificSchoolClasses 'NTNU' 
</blockquote>

<img src="images/99.jpg">

When we try to create a Stored Procedure that already exists we get the following error message.

There is already an object named 'GetSpecificSchoolClasses' in the database. 
Then we first need to delete (or DROP) the old Stored Procedure before we can recreate it again.

We can do this manually in the Management Studio in SQL like this: 

<img src="images/100.jpg">
  
A better solution is to add code for this in our script, like this: 

<blockquote>
IF EXISTS (SELECT name FROM   sysobjects  
 	WHERE name = GetSpecificSchoolClasses ' AND type = 'P') 
 	DROP PROCEDURE GetSpecificSchoolClasses 
GO 
 
CREATE PROCEDURE GetSpecificSchoolClasses 
    @SchoolName varchar(50) 
    AS  select SCHOOL.SchoolName, CLASS.ClassName from SCHOOL 
    inner join CLASS on SCHOOL.SchoolId = CLASS.SchoolId 
    where SchoolName=@SchoolName order by ClassName 
</blockquote>

So we use CREATE PROCEDURE to create a Stored Procedure and we use DROP PROCEDURE to delete a Stored Procedure. 

---

## NOCOUNT ON/NOCOUNT OFF 
In advanced Stored Procedures and Script, performance is very important. Using SET NOCOUNT ON and SET NOCOUNT OFF makes the Stored Procedure run faster. 

SET NOCOUNT ON stops the message that shows the count of the number of rows affected by a Transact-SQL statement or stored procedure from being returned as part of the result set. 

SET NOCOUNT ON prevents the sending of DONE_IN_PROC messages to the client for each statement in a stored procedure. For stored procedures that contain several statements that do not return much actual data, or for procedures that contain Transact-SQL loops, setting SET NOCOUNT to ON can provide a significant performance boost, because network traffic is greatly reduced. 

Example: 
<blockquote>
IF EXISTS (SELECT name FROM sysobjects WHERE name = 'sp_LIMS_IMPORT_REAGENT' AND type = 'P') 
    DROP PROCEDURE sp_LIMS_IMPORT_REAGENT 

GO 
 
CREATE PROCEDURE sp_LIMS_IMPORT_REAGENT 
    @Name varchar(100), 
    @LotNumber varchar(100), 
    @ProductNumber varchar(100), 
    @Manufacturer varchar(100) 
 
AS SET NOCOUNT ON 

    if not exists (SELECT ReagentId FROM LIMS_REAGENTS WHERE Name=@Name)
        INSERT INTO LIMS_REAGENTS (Name, ProductNumber, Manufacturer)
        VALUES (@Name, @ProductNumber, @Manufacturer) 

    else 

        UPDATE LIMS_REAGENTS SET [Name] = @Name, ProductNumber = @ProductNumber, Manufacturer = @Manufacturer, WHERE [Name] = @Name 
SET NOCOUNT OFF 

GO 
</blockquote>

This Stored Procedure updates a table in the database and in this case you don’t normally need feedback, sp setting SET NOCOUNT ON at the top in the stored procedure is a good idea. it is also good practice to SET NOCOUNT OFF at the bottom of the stored procedure. 
</details>

<details>
<summary> Day 4: Functions  </summary>
With SQL and SQL Server you can use lots of built-in functions or you may create your own functions. Here we will learn to use some of the most used built-in functions and in addition we will create our own function. 

# Built-in Functions 
SQL has many built-in functions for performing calculations on data. 

We have 2 categories of functions, namely aggregate functions and scalar functions. Aggregate functions return a single value, calculated from values in a column, while scalar functions return a single value, based on the input value. 

### Aggregate functions - examples: 
- AVG() - Returns the average value 
- STDEV() - Returns the standard deviation value 
- COUNT() - Returns the number of rows 
- MAX() - Returns the largest value 
- MIN() - Returns the smallest value
- SUM() - Returns the sum • etc. 

### Scalar functions - examples: 
- UPPER() - Converts a field to upper case 
- LOWER() - Converts a field to lower case 
- LEN() - Returns the length of a text field 
- ROUND() - Rounds a numeric field to the number of decimals specified 
- GETDATE() - Returns the current system date and time 
- etc. 

### String Functions 
Here are some useful functions used to manipulate with strings in SQL Server:  
- CHAR  
- CHARINDEX  
- REPLACE  
- SUBSTRING  
- LEN  
- REVERSE  
- LEFT 
- RIGHT   
- LOWER  
- UPPER  
- LTRIM  
- RTRIM 
  
Read more about these functions in the SQL Server Help. 

### Date and Time Functions 
Here are some useful Date and Time functions in SQL Server: 
- DATEPART 
- GETDATE 
- DATEADD 
- DATEDIFF 
- DAY 
- MONTH 
- YEAR 
- ISDATE  

Read more about these functions in the SQL Server Help. 

### Mathematics and Statistics Functions 
Here are some useful functions for mathematics and statistics in SQL Server: 
- COUNT 
- MIN, MAX 
- COS, SIN, TAN 
- SQRT 
- STDEV 
- MEAN 
- AVG 

Read more about these functions in the SQL Server Help. 

---

## AVG() 
The AVG() function returns the average value of a numeric column. 

Syntax: 
<blockquote>
SELECT AVG(column_name) FROM table_name 
</blockquote>

Example: 

Given a GRADE table: 
  
<img src="images/101.jpg">

We want to find the average grade for a specific student: 
<blockquote>
select AVG(Grade) as AvgGrade from GRADE where StudentId=1 
</blockquote>

<img src="images/102.jpg">

---

## COUNT() 
The COUNT() function returns the number of rows that matches a specified criteria. 
 
The COUNT(column_name) function returns the number of values (NULL values will not be counted) of the specified column: 

<blockquote>
SELECT COUNT(column_name) FROM table_name  
</blockquote>

The COUNT(*) function returns the number of records in a table: 

<blockquote>
SELECT COUNT(*) FROM table_name 
</blockquote>

We use the CUSTOMER table as an example: 

<img src="images/103.jpg">

<blockquote>
select COUNT(*) as NumbersofCustomers from CUSTOMER 
</blockquote>

<img src="images/104.jpg">

---

## The GROUP BY Statement 
Aggregate functions often need an added GROUP BY statement. 
The GROUP BY statement is used in conjunction with the aggregate functions to group the result-set by one or more columns. 

Syntax:

<blockquote>
SELECT column_name, aggregate_function(column_name) 
FROM table_name WHERE column_name operator value GROUP BY column_name 
</blockquote>

Example: 

We use the CUSTOMER table as an example: 
  
<img src="images/105.jpg">

If we try the following: 

<blockquote>
select FirstName, MAX(AreaCode) from CUSTOMER 
</blockquote>

We get the following error message: 

    Column 'CUSTOMER.FirstName' is invalid in the select list because it is not contained in either an aggregate function or the GROUP BY clause. 

The solution is to use the GROUP BY: 
<blockquote>
select FirstName, MAX(AreaCode) from CUSTOMER group by FirstName 
</blockquote>

<img src="images/106.jpg">

---

## The HAVING Clause 
The HAVING clause was added to SQL because the WHERE keyword could not be used with aggregate functions.

Syntax: 
<blockquote>
SELECT column_name, aggregate_function(column_name) 
FROM table_name 
WHERE column_name operator value 
GROUP BY column_name 
HAVING aggregate_function(column_name) operator value 
</blockquote>

We use the GRADE table as an example: 
<blockquote>
select * from GRADE 
</blockquote> 

<img src="images/107.jpg">

First we use the GROUP BY statement:
<blockquote> 
select CourseId, AVG(Grade) from GRADE group by CourseId 
</blockquote>

<img src="images/108.jpg">

While the following query: 

<blockquote>
select CourseId, AVG(Grade) from GRADE group by CourseId having AVG(Grade)>3 
</blockquote> 

<img src="images/109.jpg">

---

# User-defined Functions 
IN SQL we may also create our own functions, so-called user-defined functions. 

A user-defined function is a routine that accepts parameters, performs an action, such as a complex calculation, and returns the result of that action as a value. The return value can either be a scalar (single) value or a table. Use this statement to create a reusable routine that can be used in other queries. 
 
In SQL databases, a user-defined function provides a mechanism for extending the functionality of the database server by adding a function that can be evaluated in SQL statements. The SQL standard distinguishes between scalar and table functions. A scalar function returns only a single value (or NULL), whereas a table function returns a (relational) table comprising zero or more rows, each row with one or more columns. 

Stored Procedures vs. Functions: 
- Only functions can return a value (using the RETURN keyword).  
- Stored procedures can use RETURN keyword but without any value being passed[1]  
- Functions could be used in SELECT statements, provided they don’t do any data manipulation and also should not have any OUT or IN OUT parameters.  
- Functions must return a value, but for stored procedures this is not compulsory.  
- A function can have only IN parameters, while stored procedures may have OUT or IN OUT parameters.  
- A function is a subprogram written to perform certain computations and return a single value.  
- A stored procedure is a subprogram written to perform a set of actions, and can return multiple values using the OUT parameter or return no value at all. 
 
User-defined functions in SQL are declared using the CREATE FUNCTION statement. 

When we have created the function, we can use the function the same way we use built-in functions. 


</details>

<details>
<summary> Day 5: Triggers  </summary> 
A database trigger is code that is automatically executed in response to certain events on a particular table in a database. 

<img src="images/110.jpg">
 
Syntax for crating a Trigger:

<blockquote>
CREATE TRIGGER TriggerName on TableName 

FOR INSERT, UPDATE, DELETE 

AS 

… Create your Code here 

GO 
</blockquote>

The Trigger will automatically be executed when data is inserted, updated or deleted in the table as specified in the Trigger header. 

## INSERTED and DELETED: 
Inside triggers we can use two special tables: the DELETED table and the INSERTED tables. 
SQL Server automatically creates and manages these tables. You can use these temporary, memory-resident tables to test the effects of certain data modifications. You cannot modify the data in these tables. 
The DELETED table stores copies of the affected rows during DELETE and UPDATE statements. During the execution of a DELETE or UPDATE statement, rows are deleted from the trigger table and transferred to the DELETED table. 

The INSERTED table stores copies of the affected rows during INSERT and UPDATE statements. During an insert or update transaction, new rows are added to both the INSERTED table and the trigger table. The rows in the INSERTED table are copies of the new rows in the trigger table. 

Example: 

We will use the CUSTOMER table as an example: 
  
<img src="images/111.jpg">

We will create a TRIGGER that will check if the Phone number is valid when we insert or update data in the CUSTOMER table. The validation check will be very simple, i.e., we will check if the Phone number is less than 8 digits (which is normal length in Norway). If the Phone number is less than 8 digits, the following message “Phone Number is not valid” be written in place of the wrong number in the Phone column. 

The TRIGGER becomes something like this: 

<blockquote>
IF EXISTS (SELECT name  
 	   FROM   sysobjects  
 	   WHERE  name = 'CheckPhoneNumber'  
 	   AND    type = 'TR') 
 	
    DROP TRIGGER CheckPhoneNumber 

GO 
 
CREATE TRIGGER CheckPhoneNumber ON CUSTOMER 
FOR UPDATE, INSERT 

AS 
 
DECLARE 
@CustomerId int, 
@Phone varchar(50), 
@Message varchar(50) 
set nocount on 
 
select @CustomerId = CustomerId from INSERTED 
 
select @Phone = Phone from INSERTED 
 
set @Message = 'Phone Number ' + @Phone + ' is not valid' 
  if len(@Phone) < 8   
    update CUSTOMER set Phone = @Message where CustomerId = @CustomerId 
 
set nocount off 
 
GO 
</blockquote>

We test the TRIGGER with the following INSERT INTO statement:

<blockquote>
INSERT INTO CUSTOMER (CustomerNumber, LastName, FirstName, AreaCode, Address, Phone)  
              
              VALUES ('1003', 'Obama', 'Barak', 51, 'Nevada', '4444')  
</blockquote>

The results become: 

<img src="images/112.jpg">

As you can see, the TRIGGER works as expected. 

We try to update the Phone number to a valid number: 

<blockquote>
update CUSTOMER set Phone = '44444444' where CustomerNumber = '1003' 
</blockquote>

The results become: 

<img src="images/113.jpg">
 
</details>

<details>
<summary> Day 6: Communicate from other Applications  </summary>
 
A Database is a structured way to store lots of information. The information is stored in different tables. “Everything” today is stored in databases.

Examples: 
- Bank/Account systems  
- Information in Web pages such as Facebook, Wikipedia, YouTube 
- … lots of other examples 
  
This means we need to be able to communicate with the database from other applications and programming languages in order to insert, update or retrieve data from the database.  

## ODBC 
ODBC (Open Database Connectivity) is a standardized interface (API) for accessing the database from a client. You can use this standard to communicate with databases from different vendors, such as Oracle, SQL Server, etc. The designers of ODBC aimed to make it independent of programming languages, database systems, and operating systems. 

We will use the ODBC Data Source Administrator: 
  
<img src="images/114.jpg">

<img src="images/115.jpg">

## Microsoft Excel 
Microsoft Excel has the ability to retrieve data from different data sources, including different database systems. It is very simple to retrieve data from SQL Server into Excel since Excel and SQL Server has the same vendor (Microsoft). 
  
<img src="images/116.jpg">

<img src="images/117.jpg">

</details>

</blockquote>

---



## References

<blockquote>

1. Microsoft official SQL Server Web site - http://www.microsoft.com/sqlserver 
2. SQL Server Books Online - http://msdn.microsoft.com/en-us/library/ms166020.aspx  
3. SQL Server Help w3shools.com - http://www.w3schools.com/sql  
5. Wikipedia – Microsoft SQL Server - http://en.wikipedia.org/wiki/Microsoft_SQL_Server  
6. Wikipedia - SQL - http://en.wikipedia.org/wiki/SQL  
7. Wikipedia – Transact SQL - http://en.wikipedia.org/wiki/T-SQL  

</blockquote>

---
